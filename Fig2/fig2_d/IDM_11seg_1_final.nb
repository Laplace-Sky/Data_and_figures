(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     82928,       2268]
NotebookOptionsPosition[     81159,       2234]
NotebookOutlinePosition[     81601,       2251]
CellTagsIndexPosition[     81558,       2248]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ToMatlab`\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r0", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "+", "l"}], ")"}], "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "l"}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "-", "l"}], ")"}], "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "+", "l"}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "-", "l"}], ")"}], "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "l"}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "+", "l"}], ")"}], "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r4", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "+", "l"}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "+", "l"}], ")"}], "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r5", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"3", "*", 
          RowBox[{"l", "/", "2"}]}]}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "+", 
         RowBox[{"l", "/", "2"}]}], ")"}], "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r6", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"3", "*", 
          RowBox[{"l", "/", "2"}]}]}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "-", 
         RowBox[{"l", "/", "2"}]}], ")"}], "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r7", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"l", "/", "2"}]}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "+", 
         RowBox[{"3", "*", 
          RowBox[{"l", "/", "2"}]}]}], ")"}], "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r8", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"l", "/", "2"}]}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "-", 
         RowBox[{"3", "*", 
          RowBox[{"l", "/", "2"}]}]}], ")"}], "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r9", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "+", 
         RowBox[{"l", "/", "2"}]}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "+", 
         RowBox[{"3", "*", 
          RowBox[{"l", "/", "2"}]}]}], ")"}], "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r10", "=", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "+", 
          RowBox[{"l", "/", "2"}]}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", 
          RowBox[{"3", "*", 
           RowBox[{"l", "/", "2"}]}]}], ")"}], "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r0s", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r0", 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1s", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r1", 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2s", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r2", 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3s", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r3", 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r4s", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r4", 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r5s", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r5", 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r6s", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r6", 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r7s", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r7", 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r8s", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r8", 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r9s", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r9", 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r10s", "=", 
    RowBox[{
     RowBox[{"TransformedField", "[", 
      RowBox[{
       RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "r10", 
       ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "assume", " ", "r", " ", "to", " ", "be", " ", "different", " ", "and", 
    " ", "apply", " ", "series", " ", "expansion"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K0", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "k", "*", "r0s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", "*", "Pi", "*", 
      RowBox[{"r0s", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K1", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "k", "*", "r1s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", "*", "Pi", "*", 
      RowBox[{"r1s", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K2", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "k", "*", "r2s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", "*", "Pi", "*", 
      RowBox[{"r2s", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K3", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "k", "*", "r3s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", "*", "Pi", "*", 
      RowBox[{"r3s", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K4", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "k", "*", "r4s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", "*", "Pi", "*", 
      RowBox[{"r4s", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K5", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "k", "*", "r5s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", "*", "Pi", "*", 
      RowBox[{"r5s", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K6", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "k", "*", "r6s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", "*", "Pi", "*", 
      RowBox[{"r6s", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K7", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "k", "*", "r7s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", "*", "Pi", "*", 
      RowBox[{"r7s", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K8", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "k", "*", "r8s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", "*", "Pi", "*", 
      RowBox[{"r8s", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K9", "[", "l_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], "*", "k", "*", "r9s"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"8", "*", "Pi", "*", 
      RowBox[{"r9s", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"K10", "[", "l_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"I", "*", "k", "*", "I0", "*", "l", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "I"}], "*", "k", "*", "r10s"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"8", "*", "Pi", "*", 
       RowBox[{"r10s", "^", "2"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K0", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"K0", "[", "l", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K1", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"K1", "[", "l", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K2", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"K2", "[", "l", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K3", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"K3", "[", "l", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K4", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"K4", "[", "l", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K5", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"K5", "[", "l", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K6", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"K6", "[", "l", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K7", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"K7", "[", "l", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K8", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"K8", "[", "l", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"K9", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"K9", "[", "l", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K10", "=", 
    RowBox[{
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"K10", "[", "l", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"K8", "[", "l", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"r", "->", "Infinity"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hffxwithhighorder", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"K0", "-", "K1", "+", "K2", "-", "K3", "+", "K4"}], ")"}], "*", 
     "z"}], "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hffywithhighorder", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"K5", "-", "K6", "+", "K7", "-", "K8", "+", "K9", "-", "K10"}], 
      ")"}], "*", "z"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hffzwithhighorder", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "K0"}], "+", "K1", "-", "K2", "+", "K3", "-", "K4"}], 
        ")"}], "*", "x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "K5"}], "+", "K6", "-", "K7", "+", "K8", "-", "K9", "+",
          "K10"}], ")"}], "*", "y"}], "-", 
      RowBox[{"l", "*", 
       RowBox[{"(", 
        RowBox[{"K0", "+", "K1", "+", "K2", "+", "K3", "+", "K4", "+", 
         RowBox[{"K5", "/", "2"}], "+", 
         RowBox[{"K6", "/", "2"}], "+", 
         RowBox[{"3", "*", 
          RowBox[{"K7", "/", "2"}]}], "+", 
         RowBox[{"3", "*", 
          RowBox[{"K8", "/", "2"}]}], "+", 
         RowBox[{"3", "*", 
          RowBox[{"K9", "/", "2"}]}], "+", 
         RowBox[{"3", "*", 
          RowBox[{"K10", "/", "2"}]}]}], ")"}]}]}], ")"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Hffwithhighorder", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "Hffxwithhighorder", ",", "Hffywithhighorder", ",", "Hffzwithhighorder"}],
     "}"}], "//", "Normal"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{
     RowBox[{
     "H0", "+", "H1", "+", "H2", "+", "H3", "+", "H4", "+", "H5", "+", "H6", 
      "+", "H7", "+", "H8", "+", "H9"}], "//", "Normal"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "above", " ", "and", " ", "the", " ", "below", " ", "are", " ",
     "equal"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hffx", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "*", "I0", "*", "l", "*", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "I"}], "*", "k", "*", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"8", "*", "Pi", "*", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"5", "*", "k", "*", "l", "*", "x", "*", "z"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"I", "*", "z"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hffy", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "*", "I0", "*", "l", "*", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "I"}], "*", "k", "*", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"8", "*", "Pi", "*", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"7", "*", "k", "*", "l", "*", "y", "*", "z"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hffz", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k", "*", "I0", "*", "l", "*", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "I"}], "*", "k", "*", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"8", "*", "Pi", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], ")"}]}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"5", "*", "k", "*", "l", "*", 
         RowBox[{"x", "^", "2"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"7", "*", "k", "*", "l", "*", 
         RowBox[{"y", "^", "2"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"I", "*", "x"}], "+", 
      RowBox[{"12", "*", "I", "*", "l"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hffxconj", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "*", "I0", "*", "l", "*", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"I", "*", "k", "*", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"8", "*", "Pi", "*", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"5", "*", "k", "*", "l", "*", "x", "*", "z"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], "-", 
      RowBox[{"I", "*", "z"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hffyconj", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "*", "I0", "*", "l", "*", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"I", "*", "k", "*", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"8", "*", "Pi", "*", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"7", "*", "k", "*", "l", "*", "y", "*", "z"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hffzconj", "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"k", "*", "I0", "*", "l", "*", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"I", "*", "k", "*", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"8", "*", "Pi", "*", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"5", "*", "k", "*", "l", "*", 
          RowBox[{"x", "^", "2"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"7", "*", "k", "*", "l", "*", 
          RowBox[{"y", "^", "2"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], "-", 
       RowBox[{"I", "*", "x"}], "-", 
       RowBox[{"12", "*", "I", "*", "l"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hff", "=", 
    RowBox[{"{", 
     RowBox[{"Hffx", ",", "Hffy", ",", "Hffz"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Hffwithhighorder", "-", "Hff"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hffconj", "=", 
    RowBox[{"{", 
     RowBox[{"Hffxconj", ",", "Hffyconj", ",", "Hffzconj"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Effcalc", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"I", "*", "omega", "*", "epsilon"}], ")"}]}], ")"}], "*", 
       RowBox[{"Curl", "[", 
        RowBox[{"Hff", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "//", 
      RowBox[{"FullSimplify", "\[IndentingNewLine]", 
       RowBox[{"Effx", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", "^", "2"}], "*", "I0", "*", "l", "*", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "I"}], "*", "k", "*", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]", "*", "omega", "*", "epsilon", "*", 
             RowBox[{"r", "^", "3"}]}], ")"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k", "*", "l", "*", 
              RowBox[{"x", "^", "2"}], "*", "y"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "*", 
              RowBox[{"\[Sqrt]", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k", "*", "l", "*", 
              RowBox[{"y", "^", "3"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"\[Sqrt]", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k", "*", "l", "*", 
              RowBox[{"z", "^", "2"}], "*", "y"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"\[Sqrt]", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"I", "*", "x", "*", "y"}], ")"}], "/", "4"}]}], 
          ")"}]}]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Effy", "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", "^", "2"}], "*", "I0", "*", "l", "*", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "I"}], "*", "k", "*", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]}]]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]", "*", "omega", "*", "epsilon", "*", 
           RowBox[{"r", "^", "3"}]}], ")"}]}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "*", "l", "*", 
           RowBox[{"z", "^", "2"}], "*", "x"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "*", "l", "*", 
           RowBox[{"x", "^", "3"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "*", "l", "*", 
           RowBox[{"y", "^", "2"}], "*", "x"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"I", "*", 
           RowBox[{"x", "^", "2"}]}], ")"}], "/", "4"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"I", "*", 
           RowBox[{"z", "^", "2"}]}], ")"}], "/", "4"}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Effz", "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", "^", "2"}], "*", "I0", "*", "l", "*", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "I"}], "*", "k", "*", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]}]]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]", "*", "omega", "*", "epsilon", "*", 
           RowBox[{"r", "^", "3"}]}], ")"}]}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "*", "l", "*", "x", "*", "y", "*", "z"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"I", "*", "y", "*", "z"}], ")"}], "/", "4"}]}], ")"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Eff", "=", 
     RowBox[{"{", 
      RowBox[{"Effx", ",", "Effy", ",", "Effz"}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eff", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"I", "*", "omega", "*", "epsilon"}], ")"}]}], ")"}], "*", 
      RowBox[{"Curl", "[", 
       RowBox[{"Hff", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "//", 
     "FullSimplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hfftotal", "=", 
   RowBox[{"2", "*", "I", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"k", "*", "h", "*", 
      RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], "*", "Hff"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hfftotalconj", "=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"k", "*", "h", "*", 
      RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], "*", "Hffconj"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Efftotal", "=", 
    RowBox[{"2", "*", "I", "*", 
     RowBox[{"Sin", "[", 
      RowBox[{"k", "*", "h", "*", 
       RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], "*", "Eff"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wffx", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", "^", "5"}], "*", 
        RowBox[{"I0", "^", "2"}], "*", 
        RowBox[{"l", "^", "4"}], "*", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"k", "*", "h", "*", 
           RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], "^", "2"}]}], ")"}], 
      "/", 
      RowBox[{"(", 
       RowBox[{"8", 
        RowBox[{"\[Pi]", "^", "2"}], "*", "omega", "*", "epsilon", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"5", "/", "2"}], ")"}]}]}], ")"}]}], ")"}], "*", "x", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"z", "^", "2"}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}], "+", 
      RowBox[{"4", "*", 
       RowBox[{"y", "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"z", "^", "2"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"4", "*", 
         RowBox[{"k", "^", "2"}], "*", 
         RowBox[{"l", "^", "2"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wffy", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", "^", "5"}], "*", 
        RowBox[{"I0", "^", "2"}], "*", 
        RowBox[{"l", "^", "4"}], "*", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"k", "*", "h", "*", 
           RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], "^", "2"}]}], ")"}], 
      "/", 
      RowBox[{"(", 
       RowBox[{"8", 
        RowBox[{"\[Pi]", "^", "2"}], "*", "omega", "*", "epsilon", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"5", "/", "2"}], ")"}]}]}], ")"}]}], ")"}], "*", "y", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"z", "^", "2"}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}], "+", 
      RowBox[{"4", "*", 
       RowBox[{"y", "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"z", "^", "2"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"4", "*", 
         RowBox[{"k", "^", "2"}], "*", 
         RowBox[{"l", "^", "2"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wffz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", "^", "5"}], "*", 
        RowBox[{"I0", "^", "2"}], "*", 
        RowBox[{"l", "^", "4"}], "*", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"k", "*", "h", "*", 
           RowBox[{"Cos", "[", "theta", "]"}]}], "]"}], "^", "2"}]}], ")"}], 
      "/", 
      RowBox[{"(", 
       RowBox[{"8", 
        RowBox[{"\[Pi]", "^", "2"}], "*", "omega", "*", "epsilon", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"5", "/", "2"}], ")"}]}]}], ")"}]}], ")"}], "*", "z", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"z", "^", "2"}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}], "+", 
      RowBox[{"4", "*", 
       RowBox[{"y", "^", "2"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"z", "^", "2"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"4", "*", 
         RowBox[{"k", "^", "2"}], "*", 
         RowBox[{"l", "^", "2"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wff", "=", 
   RowBox[{"{", 
    RowBox[{"Wffx", ",", "Wffy", ",", "Wffz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WffS", "=", 
    RowBox[{
     RowBox[{"TransformedField", "[", 
      RowBox[{
       RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "Wff", 
       ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
        RowBox[{"{", 
         RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], "*", 
     RowBox[{"Cross", "[", 
      RowBox[{"Efftotal", ",", "Hfftotalconj"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WS", "=", 
   RowBox[{
    RowBox[{"TransformedField", "[", 
     RowBox[{
      RowBox[{"\"\<Cartesian\>\"", "->", "\"\<Spherical\>\""}], ",", "W", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"r", ",", "theta", ",", "phi"}], "}"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToMatlab", "[", 
   RowBox[{"WS", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ToMatlab", "[", 
       RowBox[{"WS", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"ToMatlab", "[", 
       RowBox[{"WS", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "f"}], "=", 
     RowBox[{"2.45", "*", 
      RowBox[{"10", "^", "9"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]", "=", 
     RowBox[{"3", "*", 
      RowBox[{
       RowBox[{"10", "^", "8"}], "/", "f"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"h", "=", "0.0018"}], ";", "\[IndentingNewLine]", 
    RowBox[{"l", "=", "0.01"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"I0", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"mu", "=", 
     RowBox[{"1.25663706212", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"epsilon", "=", 
     RowBox[{"8.8541878176", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "12"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Eta]", "=", " ", 
     RowBox[{"120", "*", "Pi"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"omega", "=", 
     RowBox[{"2", "*", "Pi", "*", "f"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"k", "=", 
     RowBox[{"2", "*", 
      RowBox[{"Pi", "/", "\[Lambda]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Pr", "=", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"WS", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"r", "^", "2"}], "*", 
         RowBox[{"Sin", "[", "theta", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"theta", ",", "0", ",", 
          RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phi", ",", "0", ",", 
          RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}], "//", "Simplify"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Rr", "=", 
     RowBox[{"2", "*", 
      RowBox[{"Pr", "/", 
       RowBox[{"I0", "^", "2"}]}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.883972519712391*^9, 3.883972596644005*^9}, {
   3.8839727575344095`*^9, 3.883972757746596*^9}, {3.883973032212926*^9, 
   3.8839730644252367`*^9}, {3.8839741692946696`*^9, 
   3.8839741761256733`*^9}, {3.883974328408512*^9, 3.883974331277034*^9}, {
   3.883974383911293*^9, 3.8839743925178566`*^9}, {3.8839745295042706`*^9, 
   3.8839746016186485`*^9}, {3.883974726812709*^9, 3.8839747447805004`*^9}, {
   3.883979077427084*^9, 3.8839791346223516`*^9}, {3.8839791808719997`*^9, 
   3.883979224061962*^9}, {3.8839792601466765`*^9, 3.883979288157295*^9}, {
   3.8839799491081924`*^9, 3.8839799615621386`*^9}, {3.883982111166667*^9, 
   3.8839821308289523`*^9}, {3.8839822860396194`*^9, 
   3.8839823161400747`*^9}, {3.883982370829139*^9, 3.8839824180076036`*^9}, {
   3.8839824504443655`*^9, 3.88398246438762*^9}, {3.883982567374133*^9, 
   3.883982636246664*^9}, {3.883982678172512*^9, 3.8839827920986576`*^9}, {
   3.883982832906523*^9, 3.8839828471400332`*^9}, {3.8839828775807867`*^9, 
   3.8839828810318203`*^9}, {3.8839829425649004`*^9, 
   3.8839829489665265`*^9}, {3.8839829964202323`*^9, 3.883983006094736*^9}, {
   3.883983077716753*^9, 3.883983091641992*^9}, {3.883983129572327*^9, 
   3.8839832705252085`*^9}, 3.883983556797869*^9, {3.883984115071526*^9, 
   3.883984169937747*^9}, {3.883984212913518*^9, 3.8839844754772806`*^9}, {
   3.883984512479801*^9, 3.8839845254982433`*^9}, {3.8839847889107723`*^9, 
   3.883984796191171*^9}, {3.8840274042871017`*^9, 3.884027405110826*^9}, {
   3.8840276667355747`*^9, 3.8840276867421575`*^9}, {3.884027896080141*^9, 
   3.8840278962492895`*^9}, {3.8840279319006233`*^9, 3.884027957184846*^9}, {
   3.885855815829741*^9, 3.885855887460602*^9}, {3.8858559849634056`*^9, 
   3.885855998252176*^9}, 3.885856230690591*^9, {3.885856331717317*^9, 
   3.8858563642618227`*^9}, {3.8858566920762587`*^9, 
   3.8858566981526675`*^9}, {3.8858569231643763`*^9, 
   3.8858569238060503`*^9}, {3.8858576791699133`*^9, 3.885857697552906*^9}, {
   3.8858577424763856`*^9, 3.885857746632036*^9}, {3.8858579132107744`*^9, 
   3.8858579139718704`*^9}, {3.8858579450418253`*^9, 
   3.8858579513666396`*^9}, {3.8858579857302895`*^9, 
   3.8858579990923047`*^9}, {3.88778682897691*^9, 3.8877868332266245`*^9}, {
   3.887789247682068*^9, 3.887789251660546*^9}, {3.8878271289443216`*^9, 
   3.88782713407812*^9}, {3.8878271654999104`*^9, 3.8878271741170807`*^9}, {
   3.8878272168259735`*^9, 3.8878272204930725`*^9}, 3.8878273190295143`*^9, 
   3.8878276017704544`*^9, {3.8878278523328905`*^9, 3.8878279064669805`*^9}, {
   3.887827982410793*^9, 3.887827993952493*^9}, {3.8878282270994744`*^9, 
   3.8878282745086536`*^9}, {3.887860840609824*^9, 3.887860878053131*^9}, {
   3.8878609229888496`*^9, 3.8878609230248814`*^9}, {3.887861102772109*^9, 
   3.887861107316186*^9}, {3.8878611772971535`*^9, 3.88786117938381*^9}, {
   3.8878612269100256`*^9, 3.887861227275445*^9}, {3.887861493336422*^9, 
   3.8878614953378253`*^9}, {3.8878616184183826`*^9, 3.8878616266652546`*^9}, 
   3.8878618130561967`*^9, {3.8878618544684925`*^9, 3.8878618551392365`*^9}, 
   3.8878619584611406`*^9, {3.8878621950536833`*^9, 3.8878622346131315`*^9}, 
   3.8878623278832736`*^9, {3.8878626649267583`*^9, 3.8878626982320275`*^9}, {
   3.887865377260193*^9, 3.887865387906178*^9}, {3.8878655367311263`*^9, 
   3.887865539997983*^9}, {3.8878665162400928`*^9, 3.887866519708516*^9}, {
   3.887867842592307*^9, 3.887867853084552*^9}, 3.887870500913049*^9, {
   3.8878705707472095`*^9, 3.8878706012701826`*^9}, {3.8878707174818754`*^9, 
   3.8878707259613266`*^9}, {3.8878743520820913`*^9, 
   3.8878743674641438`*^9}, {3.8879973064375315`*^9, 
   3.8879973109335136`*^9}, {3.887997371149565*^9, 3.8879973780366063`*^9}, {
   3.887997425074004*^9, 3.887997450522423*^9}, {3.8879975194828386`*^9, 
   3.887997659578194*^9}, {3.8879976899269705`*^9, 3.887997713950966*^9}, {
   3.887998171738041*^9, 3.887998251378495*^9}, {3.8879982839372587`*^9, 
   3.887998287277196*^9}, {3.88799842736244*^9, 3.8879984286618905`*^9}, 
   3.88799847223007*^9, {3.8879985024761972`*^9, 3.887998517696516*^9}, {
   3.887998709924281*^9, 3.887998711583099*^9}, {3.8879987491790695`*^9, 
   3.8879987696359587`*^9}, {3.8880004464732733`*^9, 
   3.8880004511722307`*^9}, {3.8880005364851437`*^9, 
   3.8880005380423374`*^9}, {3.8880510900518074`*^9, 3.888051185890577*^9}, {
   3.888051255401188*^9, 3.8880512728388643`*^9}, {3.8880514884303083`*^9, 
   3.888051504570663*^9}, {3.8880520795888166`*^9, 3.8880520821751547`*^9}, {
   3.888052148799527*^9, 3.8880521540721474`*^9}, {3.888376984227317*^9, 
   3.888376997334613*^9}, {3.898074977808716*^9, 3.898074991588785*^9}, 
   3.8980750277052364`*^9, 3.8982394306800423`*^9, {3.913678026739129*^9, 
   3.913678087535572*^9}, {3.9136785526321135`*^9, 3.91367856825284*^9}, {
   3.9136786235009513`*^9, 3.9136786247170954`*^9}, {3.9136786845817647`*^9, 
   3.9136786966831055`*^9}, {3.913678727007514*^9, 3.9136787344863405`*^9}, {
   3.9136802366890883`*^9, 3.913680241188137*^9}},
 CellLabel->
  "In[959]:=",ExpressionUUID->"08f29a91-4f1e-4de1-a3d4-4c103e81e61f"],

Cell[BoxData[
 TemplateBox[{
  "Needs", "nocont", 
   "\"Context \\!\\(\\*RowBox[{\\\"\\\\\\\"ToMatlab`\\\\\\\"\\\"}]\\) was not \
created when Needs was evaluated.\"", 2, 960, 13, 21745749917384590769, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.883972520474061*^9, 3.883972527391141*^9}, 
   3.8839727586704073`*^9, 3.8839730723221774`*^9, 3.8839743331456757`*^9, 
   3.8839743932585077`*^9, 3.8839745775474935`*^9, 3.883974747107546*^9, {
   3.8839789308953*^9, 3.8839789429248724`*^9}, 3.883979193618206*^9, 
   3.8839792260296917`*^9, 3.883979288865918*^9, 3.8839799637010183`*^9, 
   3.88398231770545*^9, {3.883982380513652*^9, 3.883982418753259*^9}, 
   3.8839829515588045`*^9, 3.8839832239442697`*^9, {3.883983256988312*^9, 
   3.8839832744056187`*^9}, 3.883983557302313*^9, 3.8839844672920866`*^9, 
   3.8839845281375628`*^9, 3.883984797278126*^9, 3.8840276902052016`*^9, 
   3.88402795957895*^9, 3.8858558951782017`*^9, 3.885855991826539*^9, 
   3.885856085627794*^9, 3.8858562312783766`*^9, 3.885856334289892*^9, 
   3.8858563652762933`*^9, 3.885856701553073*^9, 3.885856925959161*^9, 
   3.8858577838778253`*^9, 3.885858000449051*^9, 3.8877868343966475`*^9, 
   3.8877892521920104`*^9, {3.887827202748581*^9, 3.887827221457054*^9}, 
   3.887827327503355*^9, 3.887827642476408*^9, 3.887827912734187*^9, 
   3.88782799508703*^9, 3.8878282750582976`*^9, 3.8878608813030434`*^9, 
   3.8878609281994677`*^9, 3.8878611113547544`*^9, 3.8878611805162983`*^9, 
   3.887861229632452*^9, 3.8878614977442236`*^9, 3.8878616279719267`*^9, 
   3.8878618139030595`*^9, 3.8878618558930745`*^9, 3.8878619626145377`*^9, 
   3.887862340501652*^9, 3.8878627175013943`*^9, 3.887864804229656*^9, 
   3.8878655501720333`*^9, 3.887866520508309*^9, 3.8878678639970603`*^9, 
   3.887870528834999*^9, 3.8878707439981775`*^9, 3.8878735316131363`*^9, 
   3.887874371960605*^9, 3.887998257385965*^9, 3.887998310180523*^9, 
   3.8879985206990213`*^9, 3.8879988267031527`*^9, 3.8880004559355416`*^9, 
   3.8880005396882744`*^9, 3.8880512882345476`*^9, 3.8880515121974688`*^9, 
   3.888052114993905*^9, 3.888052162323377*^9, 3.888376998408556*^9, 
   3.898075040358593*^9, 3.8982394355278683`*^9, 3.898246509033642*^9, 
   3.9136780551671457`*^9, 3.9136786999961195`*^9, {3.9136802195264816`*^9, 
   3.9136802419768534`*^9}},
 CellLabel->
  "During evaluation of \
In[959]:=",ExpressionUUID->"e61eb12e-e7f7-435e-a282-e07208c9457e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
        SqrtBox[
         SuperscriptBox["r", "2"]]}]], " ", "I0", " ", "k", " ", "l", " ", 
      "z"}], 
     RowBox[{"8", " ", "\[Pi]", " ", 
      SuperscriptBox["r", "2"]}]], "+", 
    FractionBox[
     RowBox[{"5", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
        SqrtBox[
         SuperscriptBox["r", "2"]]}]], " ", "I0", " ", "k", " ", 
      SuperscriptBox["l", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], "+", 
        RowBox[{"k", " ", 
         SqrtBox[
          SuperscriptBox["r", "2"]]}]}], ")"}], " ", "z", " ", 
      RowBox[{"Cos", "[", "phi", "]"}], " ", 
      RowBox[{"Sin", "[", "theta", "]"}]}], 
     RowBox[{"8", " ", "\[Pi]", " ", 
      SuperscriptBox["r", "3"]}]]}], ",", 
   FractionBox[
    RowBox[{"7", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
       SqrtBox[
        SuperscriptBox["r", "2"]]}]], " ", "I0", " ", "k", " ", 
     SuperscriptBox["l", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], "+", 
       RowBox[{"k", " ", 
        SqrtBox[
         SuperscriptBox["r", "2"]]}]}], ")"}], " ", "z", " ", 
     RowBox[{"Sin", "[", "phi", "]"}], " ", 
     RowBox[{"Sin", "[", "theta", "]"}]}], 
    RowBox[{"8", " ", "\[Pi]", " ", 
     SuperscriptBox["r", "3"]}]], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
         SqrtBox[
          SuperscriptBox["r", "2"]]}]], " ", "I0", " ", "k", " ", "l", " ", 
       "x"}], 
      RowBox[{"8", " ", "\[Pi]", " ", 
       SuperscriptBox["r", "2"]}]]}], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
        SqrtBox[
         SuperscriptBox["r", "2"]]}]], " ", "I0", " ", "k", " ", 
      SuperscriptBox["l", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "12"}], " ", "\[ImaginaryI]", " ", "r"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], "+", 
           RowBox[{"k", " ", 
            SqrtBox[
             SuperscriptBox["r", "2"]]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5", " ", "x", " ", 
            RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
           RowBox[{"7", " ", "y", " ", 
            RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "theta", "]"}]}]}], ")"}]}], 
     RowBox[{"8", " ", "\[Pi]", " ", 
      SuperscriptBox["r", "3"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8878608919824286`*^9, 3.887860938823803*^9, 3.8878611218459744`*^9, 
   3.887861190984498*^9, 3.8878612401256733`*^9, 3.8878615082254343`*^9, 
   3.887861638468152*^9, 3.8878618242661667`*^9, 3.8878618663392553`*^9, 
   3.8878619730417013`*^9, 3.887862351056928*^9, 3.887862719196885*^9, 
   3.8878648059281487`*^9, 3.8878655519045563`*^9, 3.8878665208916454`*^9, 
   3.887867864363383*^9, 3.8878705292323484`*^9, 3.887870744368503*^9, 
   3.88787353201649*^9, 3.8878743723459435`*^9, 3.8879982585599937`*^9, 
   3.8879983230107865`*^9, 3.887998533707432*^9, 3.887998839943768*^9, 
   3.888000469474358*^9, 3.8880005524814425`*^9, 3.8880513009657044`*^9, 
   3.8880515246703987`*^9, 3.888052128164445*^9, 3.888052175627034*^9, 
   3.88837699908415*^9, 3.898075040984142*^9, 3.8982394355759096`*^9, 
   3.898246509106705*^9, 3.913678055239209*^9, 3.9136787001412477`*^9, {
   3.9136802196836195`*^9, 3.9136802421550107`*^9}},
 CellLabel->
  "Out[1008]=",ExpressionUUID->"8051ffeb-f628-4c05-9c68-ea13ad37fd90"],

Cell[BoxData["\<\"(1/1024).*epsilon.^(-1).*I0.^2.*k.^2.*l.^2.*omega.^(-1).*pi.\
^(-2) ...\\n  \
.*r.^(-5).*(r.^2).^(-1/2).*(4608.*k.*l.^2.*r.^2+24.*k.*r.^4+586.* ...\\n  \
k.^3.*l.^2.*r.^4+(sqrt(-1)*(-4608)).*l.^2.*(r.^2).^(1/2)+(-8).*k.* ...\\n  \
r.^2.*((-1).*r.^2+24.*l.^2.*(2+k.^2.*r.^2)).*cos(2.*phi)+6.*k.^3.* ...\\n  \
l.^2.*r.^4.*cos(4.*phi)+(-4).*k.^3.*l.^2.*r.^4.*cos(4.*phi+(-2).* ...\\n  \
theta)+192.*k.*l.^2.*r.^2.*cos(2.*(phi+(-1).*theta))+(-4).*k.* ...\\n  \
r.^4.*cos(2.*(phi+(-1).*theta))+96.*k.^3.*l.^2.*r.^4.*cos(2.*(phi+ ...\\n  \
(-1).*theta))+k.^3.*l.^2.*r.^4.*cos(4.*(phi+(-1).*theta))+(-4608) ...\\n  \
.*k.*l.^2.*r.^2.*cos(2.*theta)+8.*k.*r.^4.*cos(2.*theta)+(-584).* ...\\n  \
k.^3.*l.^2.*r.^4.*cos(2.*theta)+(sqrt(-1)*4608).*l.^2.*(r.^2).^( ...\\n  \
1/2).*cos(2.*theta)+(-2).*k.^3.*l.^2.*r.^4.*cos(4.*theta)+192.*k.* ...\\n  \
l.^2.*r.^2.*cos(2.*(phi+theta))+(-4).*k.*r.^4.*cos(2.*(phi+theta)) ...\\n  \
+96.*k.^3.*l.^2.*r.^4.*cos(2.*(phi+theta))+k.^3.*l.^2.*r.^4.*cos( ...\\n  \
4.*(phi+theta))+(-4).*k.^3.*l.^2.*r.^4.*cos(2.*(2.*phi+theta))+( ...\\n  \
-384).*k.*l.*r.^3.*sin(phi+(-1).*theta)+(sqrt(-1)*384).*l.*r.*( ...\\n  \
r.^2).^(1/2).*sin(phi+(-1).*theta)+384.*k.*l.*r.^3.*sin(phi+theta) ...\\n  \
+(sqrt(-1)*(-384)).*l.*r.*(r.^2).^(1/2).*sin(phi+theta)).*sin(h.* ...\\n  \
k.*cos(theta)).^2;\\n\"\>"], "Output",
 CellChangeTimes->{
  3.8878608919824286`*^9, 3.887860938823803*^9, 3.8878611218459744`*^9, 
   3.887861190984498*^9, 3.8878612401256733`*^9, 3.8878615082254343`*^9, 
   3.887861638468152*^9, 3.8878618242661667`*^9, 3.8878618663392553`*^9, 
   3.8878619730417013`*^9, 3.887862351056928*^9, 3.887862719196885*^9, 
   3.8878648059281487`*^9, 3.8878655519045563`*^9, 3.8878665208916454`*^9, 
   3.887867864363383*^9, 3.8878705292323484`*^9, 3.887870744368503*^9, 
   3.88787353201649*^9, 3.8878743723459435`*^9, 3.8879982585599937`*^9, 
   3.8879983230107865`*^9, 3.887998533707432*^9, 3.887998839943768*^9, 
   3.888000469474358*^9, 3.8880005524814425`*^9, 3.8880513009657044`*^9, 
   3.8880515246703987`*^9, 3.888052128164445*^9, 3.888052175627034*^9, 
   3.88837699908415*^9, 3.898075040984142*^9, 3.8982394355759096`*^9, 
   3.898246509106705*^9, 3.913678055239209*^9, 3.9136787001412477`*^9, {
   3.9136802196836195`*^9, 3.913680242443263*^9}},
 CellLabel->
  "Out[1029]=",ExpressionUUID->"b0f57412-69e8-4790-a90d-3674b5807daf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "I0", " ", "k", " ", "l", " ", 
     "y", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "x", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", "x", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", "l", " ", "x"}], "+", 
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["k", "2"], " ", "l", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"8", " ", "epsilon", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], 
      RowBox[{"5", "/", "2"}]], " ", "\[Omega]"}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "I0", " ", "k", " ", "l", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["y", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["k", "2"], " ", "l", " ", "x", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["y", "2"]}], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "4"], "+", 
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "6"}], " ", "l"}], "+", "x"}], ")"}], " ", 
           SuperscriptBox["y", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["x", "2"]}], "+", 
             SuperscriptBox["y", "2"]}], ")"}], " ", 
           SuperscriptBox["z", "2"]}], "+", 
          SuperscriptBox["z", "4"]}], ")"}]}]}], ")"}]}], 
    RowBox[{"8", " ", "epsilon", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], "3"], " ", "omega"}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "I0", " ", "k", " ", "l", " ", 
     "y", " ", "z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["k", "2"], " ", "l", " ", "x", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", "l", " ", "x"}], "+", 
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}], 
    RowBox[{"8", " ", "epsilon", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], 
      RowBox[{"5", "/", "2"}]], " ", "omega"}]]}], "}"}]], "Input",
 CellChangeTimes->{{3.887860923028885*^9, 
  3.8878609230469007`*^9}},ExpressionUUID->"f71393c2-f029-4600-a8e3-\
80a3beb53f09"],

Cell[BoxData["\"\<[(1/32).*epsilon.^(-1).*I0.^2.*k.^3.*l.^2.*pi.^(-2).*r.^(-1)\
.*( ...\\n  \
r.^2).^(-1/2).*\[Omega].^(-1).*(cos(theta).^4+(1/2).*(3+4.*k.^2.*l.^2+(1+ ...\
\\n  4.*k.^2.*l.^2).*cos(2.*phi)).*cos(theta).^2.*sin(theta).^2+(1+4.* ...\\n \
 k.^2.*l.^2).*cos(phi).^4.*sin(theta).^4+sin(phi).^2.*(16.*k.^2.* ...\\n  \
l.^2.*sin(theta).^2+cos(phi).^2.*sin(theta).^4)).*sin(h.*k.*cos( ...\\n  \
theta)).^2,(sqrt(-1)*(1/128)).*epsilon.^(-1).*I0.^2.*k.^2.*l.^2.* ...\\n  \
pi.^(-2).*r.^(-3).*(r.^2).^(-1/2).*omega.^(-1).*sin(phi).^2.*sin(2.* ...\\n  \
theta).*((-4).*(r.^2).^(1/2)+(-6).*k.^2.*l.^2.*(r.^2).^(1/2)+(-6) ...\\n  \
.*k.^2.*l.^2.*(r.^2).^(1/2).*cos(2.*phi)+3.*k.^2.*l.^2.*(r.^2).^( ...\\n  \
1/2).*cos(2.*(phi+(-1).*theta))+6.*k.^2.*l.^2.*(r.^2).^(1/2).*cos( ...\\n  \
2.*theta)+3.*k.^2.*l.^2.*(r.^2).^(1/2).*cos(2.*(phi+theta))+(sqrt( ...\\n  \
-1)*2).*k.*l.*r.*sin(phi+(-1).*theta)+(sqrt(-1)*(-2)).*k.*l.*r.* ...\\n  \
sin(phi+theta)).*sin(h.*k.*cos(theta)).^2,(sqrt(-1)*(1/128)).* ...\\n  \
epsilon.^(-1).*I0.^2.*k.^2.*l.^2.*pi.^(-2).*r.^(-3).*(r.^2).^( ...\\n  \
-1/2).*omega.^(-1).*sin(phi).*sin(theta).*(2.*((-4)+15.*k.^2.*l.^2).*( ...\\n \
 r.^2).^(1/2).*cos(phi)+k.*l.*((-6).*k.*l.*(r.^2).^(1/2).*cos(3.* ...\\n  \
phi)+(-15).*k.*l.*(r.^2).^(1/2).*cos(phi+(-2).*theta)+3.*k.*l.*( ...\\n  \
r.^2).^(1/2).*cos(3.*phi+(-2).*theta)+(-15).*k.*l.*(r.^2).^(1/2).* ...\\n  \
cos(phi+2.*theta)+3.*k.*l.*(r.^2).^(1/2).*cos(3.*phi+2.*theta)+( ...\\n  \
sqrt(-1)*2).*r.*sin(2.*phi+(-1).*theta)+(sqrt(-1)*(-36)).*r.*sin( ...\\n  \
theta)+(sqrt(-1)*(-2)).*r.*sin(2.*phi+theta))).*sin(h.*k.*cos( ...\\n  \
theta)).^2];\\n\>\""], "Input",
 CellChangeTimes->{{3.8878609230509043`*^9, 
  3.8878609230699205`*^9}},ExpressionUUID->"a6db5df7-0115-4e0a-9cb8-\
01f5774e885f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
        SqrtBox[
         SuperscriptBox["r", "2"]]}]], " ", "I0", " ", "k", " ", "l", " ", 
      "z"}], 
     RowBox[{"8", " ", "\[Pi]", " ", 
      SuperscriptBox["r", "2"]}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
        SqrtBox[
         SuperscriptBox["r", "2"]]}]], " ", "I0", " ", "k", " ", 
      SuperscriptBox["l", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], "+", 
        RowBox[{"k", " ", 
         SqrtBox[
          SuperscriptBox["r", "2"]]}]}], ")"}], " ", "z", " ", 
      RowBox[{"Cos", "[", "phi", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox["r", "3"]}]]}], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
       SqrtBox[
        SuperscriptBox["r", "2"]]}]], " ", "I0", " ", "k", " ", 
     SuperscriptBox["l", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], "+", 
       RowBox[{"k", " ", 
        SqrtBox[
         SuperscriptBox["r", "2"]]}]}], ")"}], " ", "z", " ", 
     RowBox[{"Sin", "[", "theta", "]"}], " ", 
     RowBox[{"Sin", "[", "phi", "]"}]}], 
    RowBox[{"2", " ", "\[Pi]", " ", 
     SuperscriptBox["r", "3"]}]], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
         SqrtBox[
          SuperscriptBox["r", "2"]]}]], " ", "I0", " ", "k", " ", "l", " ", 
       "x"}], 
      RowBox[{"8", " ", "\[Pi]", " ", 
       SuperscriptBox["r", "2"]}]]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
        SqrtBox[
         SuperscriptBox["r", "2"]]}]], " ", "I0", " ", "k", " ", 
      SuperscriptBox["l", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "\[ImaginaryI]", " ", "r"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], "+", 
           RowBox[{"k", " ", 
            SqrtBox[
             SuperscriptBox["r", "2"]]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "theta", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", 
            RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
           RowBox[{"2", " ", "y", " ", 
            RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}]}], ")"}]}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox["r", "3"]}]]}]}], "}"}]], "Input",
 CellChangeTimes->{{3.887860866491909*^9, 
  3.8878608780651417`*^9}},ExpressionUUID->"68c374e5-a91d-491c-a591-\
c0882dfdd230"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "I0", " ", "k", " ", "l", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "z"}], "+", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "l", " ", "x", " ", "z"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]]}], ")"}]}], 
    RowBox[{"8", " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "I0", " ", 
     SuperscriptBox["k", "2"], " ", 
     SuperscriptBox["l", "2"], " ", "y", " ", "z"}], 
    RowBox[{"2", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], " ", "I0", " ", "k", " ", "l", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "x"}], "+", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "l", " ", 
          SuperscriptBox["x", "2"]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]], "+", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "l", " ", 
          SuperscriptBox["y", "2"]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]]}], ")"}]}], 
     RowBox[{"8", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.883972521207706*^9, 3.883972527429173*^9}, 
   3.8839727588655787`*^9, 3.883973072465303*^9, 3.88397433346996*^9, 
   3.8839743934676905`*^9, 3.883974577697626*^9, 3.883974747335746*^9, {
   3.883978931116493*^9, 3.883978943142062*^9}, 3.8839791938614197`*^9, 
   3.8839792264100266`*^9, 3.8839792986795425`*^9, 3.8839799639302197`*^9, 
   3.8839823179216394`*^9, {3.8839823807228346`*^9, 3.88398241900348*^9}, 
   3.8839829612463183`*^9, 3.8839832241924872`*^9, {3.8839832572265205`*^9, 
   3.883983274727902*^9}, 3.883983557565544*^9, 3.883984467558321*^9, 
   3.8839845286049733`*^9, 3.883984797554369*^9, 3.884027690595545*^9, 
   3.884027973526207*^9, 3.8858559061017866`*^9, 3.8858560019063797`*^9, 
   3.8858560960729556`*^9, 3.885856241566401*^9, 3.8858563445208664`*^9, 
   3.8858563755653176`*^9, 3.88585671186712*^9, 3.88585692764664*^9, 
   3.885857785521267*^9, 3.885858002097497*^9, 3.8877868370649786`*^9, 
   3.8877892522510624`*^9, {3.887827205043619*^9, 3.8878272316009693`*^9}, 
   3.8878273377133274`*^9, 3.887827652677373*^9, 3.887827922940156*^9, 
   3.8878280053440433`*^9, 3.8878282854344163`*^9},
 CellLabel->
  "Out[658]=",ExpressionUUID->"0ffe7048-5ee9-41ad-85c6-0427fa13a831"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "I0", " ", "k", " ", "l", " ", 
     "y", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "x", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", "x", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", "l", " ", "x"}], "+", 
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["k", "2"], " ", "l", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"8", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], 
      RowBox[{"5", "/", "2"}]], " ", "\[CurlyEpsilon]", " ", "omega"}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "I0", " ", "k", " ", "l", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["y", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["k", "2"], " ", "l", " ", "x", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["y", "2"]}], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "4"], "+", 
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "6"}], " ", "l"}], "+", "x"}], ")"}], " ", 
           SuperscriptBox["y", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["x", "2"]}], "+", 
             SuperscriptBox["y", "2"]}], ")"}], " ", 
           SuperscriptBox["z", "2"]}], "+", 
          SuperscriptBox["z", "4"]}], ")"}]}]}], ")"}]}], 
    RowBox[{"8", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], "3"], " ", "epsilon", " ", 
     "omega"}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "I0", " ", "k", " ", "l", " ", 
     "y", " ", "z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["k", "2"], " ", "l", " ", "x", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"6", " ", "l", " ", "x"}], "+", 
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}], 
    RowBox[{"8", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], 
      RowBox[{"5", "/", "2"}]], " ", "epsilon", " ", "omega"}]]}], "}"}]], \
"Input",
 CellChangeTimes->{{3.887860840648858*^9, 3.887860840679885*^9}, {
  3.8878609230739245`*^9, 
  3.887860923078929*^9}},ExpressionUUID->"8cf90877-b174-4316-8706-\
ab662d87ed68"],

Cell[BoxData["\"\<[(1/32).*I0.^2.*k.^3.*l.^2.*pi.^(-2).*r.^(-1).*(r.^2).^(-1/\
2).* ...\\n  \
\[CurlyEpsilon].^(-1).*omega.^(-1).*(cos(theta).^4+(1/2).*cos(theta).^2.*(3+4.\
*k.^2.*l.^2+( ...\\n  \
1+4.*k.^2.*l.^2).*cos(2.*phi)).*sin(theta).^2+(1+4.*k.^2.*l.^2).*cos(phi) ...\
\\n  .^4.*sin(theta).^4+16.*k.^2.*l.^2.*sin(theta).^2.*sin(phi).^2+cos(phi).^\
2.* ...\\n  \
sin(theta).^4.*sin(phi).^2).*sin(h.*k.*cos(theta)).^2,(sqrt(-1)*(1/128)) \
...\\n  .*I0.^2.*k.^2.*l.^2.*pi.^(-2).*r.^(-3).*(r.^2).^(-1/2).*epsilon.^(-1).\
* ...\\n  \
omega.^(-1).*sin(2.*theta).*sin(phi).^2.*((-4).*(r.^2).^(1/2)+(-6).*k.^2.* \
...\\n  l.^2.*(r.^2).^(1/2)+6.*k.^2.*l.^2.*(r.^2).^(1/2).*cos(2.*theta)+3.* \
...\\n  k.^2.*l.^2.*(r.^2).^(1/2).*cos(2.*(theta+(-1).*phi))+(-6).*k.^2.*l.^2.\
*( ...\\n  \
r.^2).^(1/2).*cos(2.*phi)+3.*k.^2.*l.^2.*(r.^2).^(1/2).*cos(2.*(theta+phi) \
...\\n  )+(sqrt(-1)*(-2)).*k.*l.*r.*sin(theta+(-1).*phi)+(sqrt(-1)*(-2)).*k.*\
l.* ...\\n  \
r.*sin(theta+phi)).*sin(h.*k.*cos(theta)).^2,(sqrt(-1)*(1/128)).*I0.^2.* \
...\\n  k.^2.*l.^2.*pi.^(-2).*r.^(-3).*(r.^2).^(-1/2).*epsilon.^(-1).*omega.^(\
-1).* ...\\n  \
sin(theta).*sin(phi).*(3.*k.^2.*l.^2.*(r.^2).^(1/2).*cos(2.*theta+(-3).*phi)+(\
 ...\\n  -15).*k.^2.*l.^2.*(r.^2).^(1/2).*cos(2.*theta+(-1).*phi)+(-8).*(r.^2)\
.^( ...\\n  \
1/2).*cos(phi)+30.*k.^2.*l.^2.*(r.^2).^(1/2).*cos(phi)+(-6).*k.^2.* ...\\n  \
l.^2.*(r.^2).^(1/2).*cos(3.*phi)+(-15).*k.^2.*l.^2.*(r.^2).^(1/2).* ...\\n  \
cos(2.*theta+phi)+3.*k.^2.*l.^2.*(r.^2).^(1/2).*cos(2.*theta+3.*phi)+(sqrt(-1)\
 ...\\n  *(-36)).*k.*l.*r.*sin(theta)+(sqrt(-1)*(-2)).*k.*l.*r.*sin(theta+(-2)\
.*phi)+ ...\\n  \
(sqrt(-1)*(-2)).*k.*l.*r.*sin(theta+2.*phi)).*sin(h.*k.*cos(theta)).^2]; \
...\\n  \\n\>\""], "Input",
 CellChangeTimes->{{3.887860840683889*^9, 3.8878608781251945`*^9}, {
  3.8878609230819316`*^9, 
  3.887860923087937*^9}},ExpressionUUID->"c33d6bab-1c6c-49b8-8f1b-\
b19ce7535d46"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.8839745239073496`*^9, 3.8839745239183598`*^9}, 
   3.8839789391675696`*^9},ExpressionUUID->"2f1ed8fd-1504-485f-bb84-\
e4f9be278f6f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.883982897317133*^9, 
  3.883982960846968*^9}},ExpressionUUID->"a26b9356-af95-44a8-a7f9-\
392de6570ffe"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8839841892317038`*^9, 3.883984205096647*^9}, 
   3.884026468059948*^9},ExpressionUUID->"7ef64df1-35d9-476b-936a-\
e8c7e9e8b964"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{{3.883982903541603*^9, 3.8839829374854355`*^9}, 
   3.8839842062116275`*^9},
 CellLabel->
  "Out[1506]=",ExpressionUUID->"4623bc81-00e7-46f6-84dc-46591c3ddfa0"]
}, Open  ]]
},
WindowSize->{798., 1371.75},
WindowMargins->{{Automatic, -811.75}, {Automatic, -117.75}},
Magnification:>1.1 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a9347096-18f8-4983-a95e-afe21e8b62bc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 48871, 1412, 3375, "Input",ExpressionUUID->"08f29a91-4f1e-4de1-a3d4-4c103e81e61f"],
Cell[49454, 1436, 2442, 38, 30, "Message",ExpressionUUID->"e61eb12e-e7f7-435e-a282-e07208c9457e"],
Cell[51899, 1476, 4175, 108, 185, "Output",ExpressionUUID->"8051ffeb-f628-4c05-9c68-ea13ad37fd90"],
Cell[56077, 1586, 2380, 34, 413, "Output",ExpressionUUID->"b0f57412-69e8-4790-a90d-3674b5807daf"]
}, Open  ]],
Cell[58472, 1623, 5415, 157, 307, "Input",ExpressionUUID->"f71393c2-f029-4600-a8e3-80a3beb53f09"],
Cell[63890, 1782, 1779, 25, 471, "Input",ExpressionUUID->"a6db5df7-0115-4e0a-9cb8-01f5774e885f"],
Cell[CellGroupData[{
Cell[65694, 1811, 3216, 94, 247, "Input",ExpressionUUID->"68c374e5-a91d-491c-a591-c0882dfdd230"],
Cell[68913, 1907, 4029, 102, 149, "Output",ExpressionUUID->"0ffe7048-5ee9-41ad-85c6-0427fa13a831"]
}, Open  ]],
Cell[72957, 2012, 5477, 160, 307, "Input",ExpressionUUID->"8cf90877-b174-4316-8706-ab662d87ed68"],
Cell[78437, 2174, 1915, 33, 513, "Input",ExpressionUUID->"c33d6bab-1c6c-49b8-8f1b-b19ce7535d46"],
Cell[80355, 2209, 200, 3, 52, "Input",ExpressionUUID->"2f1ed8fd-1504-485f-bb84-e4f9be278f6f"],
Cell[80558, 2214, 152, 3, 31, "Input",ExpressionUUID->"a26b9356-af95-44a8-a7f9-392de6570ffe"],
Cell[CellGroupData[{
Cell[80735, 2221, 177, 3, 31, "Input",ExpressionUUID->"7ef64df1-35d9-476b-936a-e8c7e9e8b964"],
Cell[80915, 2226, 228, 5, 52, "Output",ExpressionUUID->"4623bc81-00e7-46f6-84dc-46591c3ddfa0"]
}, Open  ]]
}
]
*)

